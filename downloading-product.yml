steps:
- checkout: self

- task: CmdLine@2
  displayName: 'Login Org QA'
  inputs:
    script: 'apic login -s $(server-apic) -r $(region-apic)  -u $(user-apic-qa) -p $(pass-apic-qa)'

- task: CmdLine@2
  displayName: 'List all products'
  inputs:
    script: 'apic products:list-all -s $(server-apic) -o $(name-apic-dev) --scope catalog --catalog  demo'


- task: CmdLine@2
  displayName: 'Download Product'
  inputs:
    script: |
      cd templates/assets
      apic draft-products:get $(name-product):$(version-product) -s $(server-apic) -o $(name-apic-dev)

- task: CmdLine@2
  displayName: 'Downliad APIs'
  inputs:
    script: |
      cd templates/assets
      apic draft-apis:get $(name-api-001):$(version-api-001) -o $(name-apic-dev) -s {server}
      apic draft-apis:get $(name-api-002):$(version-api-002) -o $(name-apic-dev) -s {server}

- task: CmdLine@2
  displayName: 'Setting git config'
  inputs:
    script: |
      git config --global user.email "hinostrozajosselyn@gmail.com"
      git config --global user.name "jossHD"

- task: CmdLine@2
  displayName: 'Pushing the changes in GitHub'
  inputs:
    script: |
      git add .
      git commit -m "Adding APIs"
      git push origin HEAD:main


- task: CmdLine@2
  displayName: 'Logout Org QA'
  inputs:
    script: 'apic logout -s $(server-apic)'
